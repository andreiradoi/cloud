#+BEGIN_SRC sql :engine postgresql :exports results :cmdline -h 127.0.0.1 -U fieldkit

SELECT u.id AS user_id, u.name AS user, u.email AS email, p.id AS project_id, p.name AS project_name
         FROM fieldkit.user AS u
	LEFT JOIN fieldkit.project_user AS pu ON (pu.user_id = u.id)
	LEFT JOIN fieldkit.project AS p ON (p.id = pu.project_id)
	ORDER BY user_id, project_id

#+END_SRC

#+RESULTS:
| user_id | user             | email                            | project_id | project_name             |
|---------+------------------+----------------------------------+------------+--------------------------|
|       2 | Jacob Lewallen   | jacob@conservify.org             |          1 | Demo Project             |
|       3 | Shah Selbe       | shah@conservify.org              |          3 | Default FieldKit Project |
|       4 | Libbey White     | libbey@conservify.org            |          5 | Default FieldKit Project |
|       4 | Libbey White     | libbey@conservify.org            |          9 | Test project             |
|       5 | Bradley Gawthrop | bradley@conservify.org           |            |                          |
|       6 | Kristi Cervania  | kristi@conservify.org            |            |                          |
|       7 | Susan Allen      | susan@susanallen.me              |          4 | Default FieldKit Project |
|       7 | Susan Allen      | susan@susanallen.me              |          8 | Susan Test Project       |
|       8 | Graeme Rae       | graemerae@gmail.com              |          2 | Default FieldKit Project |
|       9 | Lauren McElroy   | lauren@conservify.org            |            |                          |
|      10 | Jer Throp        | jer@conservify.org               |          6 | Default FieldKit Project |
|      11 | Ricky            | ricky@adventurescientists.org    |            |                          |
|      12 | Max Littlefield  | Max@adventurescientists.org      |            |                          |
|      13 | Kristi           | cervaniakris@gmail.com           |            |                          |
|      16 | Michelle Todhack | michelle@adventurescientists.org |            |                          |
|      21 | Paulo            | paolivas@fiu.edu                 |          7 | FIU FieldKit Test        |
|      22 | testsusan        | suedonym85+1@gmail.com           |         10 | Default FieldKit Project |
|      25 | sudantest        | suedonym85@gmail.com             |         11 | Default FieldKit Project |
|      26 | Demo             | demo@conservify.org              |          1 | Demo Project             |
|      26 | Demo             | demo@conservify.org              |         12 | Default FieldKit Project |
|      27 | Ari              | ahkoeppel@gmail.com              |         13 | Default FieldKit Project |
|      28 | RobertH          | robertherrera042@gmail.com       |            |                          |
|      29 | MatthewStockard  | matthewc.stockard@gmail.com      |            |                          |
|      30 | nick mian        | nickmian@gmail.com               |            |                          |
|      31 | Gary Ananian     | gary@kernriverconservancy.org    |         14 | Default FieldKit Project |
|      32 | Marvin           | marvinroesinger1992@gmail.com    |            |                          |

#+BEGIN_SRC sql :engine postgresql :exports results :cmdline -h 127.0.0.1 -U fieldkit

SELECT s.id AS station_id, s.name AS station_name, o.id AS owner_id, o.name AS owner, p.id AS project_id, p.name AS project_name
		 FROM fieldkit.station AS s
    LEFT JOIN fieldkit.user AS o ON (s.owner_id = o.id)
	LEFT JOIN fieldkit.project_station AS ps ON (ps.station_id = s.id)
	LEFT JOIN fieldkit.project AS p ON (p.id = ps.project_id)
	 ORDER BY station_id, project_id

#+END_SRC

#+RESULTS:
| station_id | station_name           | owner_id | owner           | project_id | project_name       |
|------------+------------------------+----------+-----------------+------------+--------------------|
|          1 | Ambitious Stingray 65  |        2 | Jacob Lewallen  |            |                    |
|          2 | Admired Goose 81       |       10 | Jer Throp       |            |                    |
|          3 | Nice-nice Lizard 98    |        6 | Kristi Cervania |            |                    |
|          5 | swift fieldkit         |        8 | Graeme Rae      |            |                    |
|          6 | Bewitched Husky 17     |        2 | Jacob Lewallen  |            |                    |
|          7 | Scholarly Eagle 59     |       12 | Max Littlefield |            |                    |
|          8 | Unusual Goat 80        |       12 | Max Littlefield |            |                    |
|          9 | Extroverted Dolphin 12 |       12 | Max Littlefield |            |                    |
|         10 | Superb Kangaroo 63     |       12 | Max Littlefield |            |                    |
|         11 | Fuzzy Chicken 8        |        7 | Susan Allen     |          8 | Susan Test Project |
|         12 | Jolly Penguin 81       |        2 | Jacob Lewallen  |          1 | Demo Project       |
|         13 | Athletic Quail 73      |        3 | Shah Selbe      |            |                    |
|         14 | Loud Dog 19            |       21 | Paulo           |          7 | FIU FieldKit Test  |
|         15 | Massive Panda          |       21 | Paulo           |          7 | FIU FieldKit Test  |
|         16 | Formal Mayfly 65       |        3 | Shah Selbe      |            |                    |
|         17 | Gifted Sloth 44        |        2 | Jacob Lewallen  |            |                    |
|         18 | Notable Dog 27         |       27 | Ari             |            |                    |
|         19 | Chatty Mayfly 85       |       31 | Gary Ananian    |            |                    |
|         20 | Highland Park Selbe    |        3 | Shah Selbe      |            |                    |
|         21 | Handy Dragonfly 25     |        3 | Shah Selbe      |            |                    |
|         22 | Joyous Rat 3           |        2 | Jacob Lewallen  |            |                    |


#+BEGIN_SRC sql :engine postgresql :exports results :cmdline -h 127.0.0.1 -U fieldkit

UPDATE fieldkit.project SET name = 'Demo Project' WHERE id = 1;
INSERT INTO fieldkit.project_station (project_id, station_id) VALUES (1, 12) ON CONFLICT DO NOTHING;
INSERT INTO fieldkit.project_user (project_id, user_id) VALUES (1, 26) ON CONFLICT DO NOTHING;

#+END_SRC

#+RESULTS:
| UPDATE 1   |
|------------|
| INSERT 0 0 |
| INSERT 0 0 |

#+BEGIN_SRC sql :engine postgresql :exports results :cmdline -h 127.0.0.1 -U fieldkit

SELECT ST_Buffer(ST_GeomFromText('POINT(1 1)'), 10) ~ ST_MakeBox2D(ST_MakePoint(0,0), ST_MakePoint(2,2)) AS contains;

#+END_SRC

#+RESULTS:
| contains |
|----------|
| t        |
